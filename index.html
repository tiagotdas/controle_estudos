<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrador de Estudos Avan√ßado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Aplica o modo escuro imediatamente para evitar flash de tela clara
        if (localStorage.getItem('studyLogDarkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }
    </script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200">

    <!-- Container para Notifica√ß√µes Toast -->
    <div id="toast-container" class="fixed bottom-5 right-5 z-50 space-y-2"></div>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="flex justify-between items-center mb-8">
            <div class="text-left">
                <h1 class="text-4xl font-bold text-gray-900 dark:text-white">Registrador de Estudos</h1>
                <p class="text-gray-600 dark:text-gray-400 mt-2">Sua ferramenta para acompanhar o progresso e agendar revis√µes.</p>
            </div>
            <button id="dark-mode-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                <!-- √çcone ser√° inserido via JS -->
            </button>
        </header>

        <!-- Se√ß√£o de Lembretes -->
        <div id="reminders-section" class="mb-8"></div>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Coluna do Formul√°rio e Cron√¥metro -->
            <div class="lg:col-span-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg fade-in self-start">
                <!-- Se√ß√£o do Cron√¥metro -->
                <div class="text-center mb-6 border-b dark:border-gray-700 pb-6">
                     <h2 class="text-2xl font-semibold mb-4">Cron√¥metro de Estudo</h2>
                     <div id="stopwatch-display" class="text-5xl font-mono tracking-widest bg-gray-900 dark:bg-black text-white rounded-lg py-4 mb-4">
                        00:00:00
                     </div>
                     <div class="flex justify-center space-x-3">
                        <button id="start-btn" class="bg-green-600 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:bg-green-700 transition-colors duration-300">Iniciar</button>
                        <button id="pause-btn" class="bg-yellow-500 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:bg-yellow-600 transition-colors duration-300" disabled>Pausar</button>
                        <button id="stop-btn" class="bg-red-600 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:bg-red-700 transition-colors duration-300" disabled>Parar</button>
                     </div>
                </div>

                <h2 class="text-2xl font-semibold mb-6">Novo Registro</h2>
                <form id="study-form" class="space-y-4">
                    <div class="flex items-end gap-4">
                        <div class="flex-grow">
                            <label for="subject" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Assunto</label>
                            <input type="text" id="subject" name="subject" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        </div>
                         <input type="color" id="subject-color" value="#54a0ff" title="Escolha uma cor para o assunto">
                    </div>
                    <div class="grid grid-cols-3 gap-4">
                        <div class="col-span-2">
                            <label for="date" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Data</label>
                            <input type="date" id="date" name="date" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm">
                        </div>
                        <div>
                            <label for="lesson-number" class="block text-sm font-medium text-gray-700 dark:text-gray-300">N¬∫ Aula</label>
                            <input type="number" id="lesson-number" name="lesson-number" min="1" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="start-time" class="block text-sm font-medium text-gray-700 dark:text-gray-300">In√≠cio</label>
                            <input type="time" id="start-time" name="start-time" required class="mt-1 block w-full px-3 py-2 bg-gray-200 dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm" readonly>
                        </div>
                        <div>
                            <label for="end-time" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Fim</label>
                            <input type="time" id="end-time" name="end-time" required class="mt-1 block w-full px-3 py-2 bg-gray-200 dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm" readonly>
                        </div>
                    </div>
                    <div>
                        <label for="comments" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Coment√°rios</label>
                        <textarea id="comments" name="comments" rows="3" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm"></textarea>
                    </div>
                    <div>
                        <label for="reminder-date" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Lembrete de Revis√£o</label>
                        <div class="flex items-center gap-2 mt-1">
                            <input type="date" id="reminder-date" name="reminder-date" class="block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm">
                            <button type="button" class="reminder-shortcut-btn px-2 py-1 text-xs border dark:border-gray-600 rounded-md" data-days="1">+1d</button>
                            <button type="button" class="reminder-shortcut-btn px-2 py-1 text-xs border dark:border-gray-600 rounded-md" data-days="7">+7d</button>
                            <button type="button" class="reminder-shortcut-btn px-2 py-1 text-xs border dark:border-gray-600 rounded-md" data-days="30">+30d</button>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button type="button" id="clear-form-btn" class="w-1/3 bg-gray-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-600">Limpar</button>
                        <button type="submit" class="w-2/3 bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700">
                           <span id="save-btn-text">Salvar Registro</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Coluna da Tabela e Gr√°fico -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Gr√°fico -->
                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg fade-in">
                    <div class="flex justify-between items-center mb-4 border-b dark:border-gray-700 pb-3">
                         <h2 class="text-2xl font-semibold">Tempo por Assunto</h2>
                         <div class="flex rounded-lg p-1 bg-gray-200 dark:bg-gray-700">
                            <button id="pie-chart-btn" class="px-3 py-1 text-sm font-semibold rounded-md bg-indigo-600 text-white">Pizza</button>
                            <button id="bar-chart-btn" class="px-3 py-1 text-sm font-semibold rounded-md text-gray-700 dark:text-gray-300">Barras</button>
                         </div>
                    </div>
                    <div class="mx-auto">
                        <canvas id="study-chart"></canvas>
                    </div>
                </div>
                <!-- Tabela de Registros -->
                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg fade-in">
                    <div class="border-b dark:border-gray-700 pb-4 mb-4">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-semibold">Hist√≥rico de Estudos</h2>
                            <div class="flex space-x-2">
                                <button id="export-csv-btn" class="bg-green-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-green-700 text-sm">Exportar CSV</button>
                                <button id="clear-all-btn" class="bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-red-700 text-sm">Limpar Tudo</button>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="search" id="search-input" placeholder="üîé Pesquisar por assunto..." class="w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm">
                            <div class="flex items-center gap-2">
                                <input type="date" id="filter-start-date" class="w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm">
                                <span class="text-gray-500 dark:text-gray-400">at√©</span>
                                <input type="date" id="filter-end-date" class="w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm">
                                <button id="clear-filter-btn" class="p-2 text-sm text-gray-500 hover:text-red-500" title="Limpar filtro">‚úñ</button>
                            </div>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Assunto</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Data</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Dura√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="logs-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"></tbody>
                        </table>
                        <p id="no-data-message" class="text-center text-gray-500 py-8">Nenhum registro encontrado.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Edi√ß√£o -->
    <div id="edit-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full hidden z-50">
        <!-- Conte√∫do do modal de edi√ß√£o ser√° preenchido via JS -->
    </div>

    <script src="script.js" defer></script>
</body>
</html>